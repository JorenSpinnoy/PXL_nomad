---
- hosts: all
  become: yes
  tasks: 
    - name: update packages
      yum:
        name: '*'
        update_cache: true
        state: 'latest'

    - name: install yum-utils
      yum: 
        name: yum-utils
        state: present

    - name: add hashicorp repo
      yum_repository:
        name: hashicorp-repo
        description: add hashicorp repo with nomad and consul
        baseurl: https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo

    - name: install consul
      yum: 
        name: consul
        state: present

    - name: enable consul
      systemd:
        name: consul
        state: started
        enabled: yes